# grep命令的使用
>_Belonging to: linux_learning_

>_`linux指令` `grep` `关键字匹配`_

>_Written date: 2020.05.27_

>_All knowledge is for learning use only, not for commercial use, and the author reserves all rights._

----------
linux的grep命令还是非常实用滴。

### 一、概述

当我们想在代码库里搜索某个打印语句的位置或者某个函数的定义（如果没有IDE的情况），grep就派上用场了。另外我们经常有log日志需要查看，但是如果log日志很大，几十M级别甚至更大的日志，用vim打开那直接卡死……
当然可以用head、tail等命令查看前几行或后几行，但是想在日志里搜索一些信息的话，就需要用grep命令了！

作为linux中最为常用的三大文本（awk，sed，grep）处理工具之一，掌握好其用法是很有必要的。

命令格式为：grep  [选项]  “模式”  [文件]

grep家族总共有三个：grep，egrep，fgrep

常用选项：
- 　　-E ：开启扩展（Extend）的正则表达式。
- 　　-i ：忽略大小写（ignore case）。
- 　　-v ：反过来（invert），只打印没有匹配的，而匹配的反而不打印。
- 　　-n ：显示行号
- 　　-w ：被匹配的文本只能是单词，而不能是单词中的某一部分，如文本中有liker，而我搜寻的只是like，就可以使用-w选项来避免匹配liker
- 　　-c ：显示总共有多少行被匹配到了，而不是显示被匹配到的内容，注意如果同时使用-cv选项是显示有多少行没有被匹配到。
- 　　-o ：只显示被模式匹配到的字符串。
- 　　--color :将匹配到的内容以颜色高亮显示。
- 　　-A  n：显示匹配到的字符串所在的行及其后n行，after
- 　　-B  n：显示匹配到的字符串所在的行及其前n行，before
- 　　-C  n：显示匹配到的字符串所在的行及其前后各n行，context

直接输入要匹配的字符串，这个可以用fgrep（fast grep）代替来提高查找速度，比如我要匹配一下hello.c文件中printf的个数：fgrep  -c  "printf"  hello.c

### 二、正则表达式匹配

这个和常规的正则表达式的用法是一致的，用过正则表达式的人都不会陌生。基本正则表达式的使用：

#### 1. 匹配字符

. ：任意一个字符。
　
[abc] ：表示匹配一个字符，这个字符必须是abc中的一个.

[a-zA-Z] ：表示匹配一个字符，这个字符必须是a-z或A-Z这52个字母中的一个。

[^123] ：匹配一个字符，这个字符是除了1、2、3以外的所有字符。

[A-Za-z] 等价于 [[:alpha:]]

[0-9] 等价于 [[:digit:]]

[A-Za-z0-9] 等价于 [[:alnum:]]

tab,space 等空白字符 [[:space:]]

[A-Z] 等价于 [[:upper:]]

[a-z] 等价于 [[:lower:]]

标点符号 [[:punct:]]

#### 2. 匹配次数

\\{m,n\\} ：匹配其前面出现的字符至少m次，至多n次。

\\? ：匹配其前面出现的内容0次或1次，等价于\\{0,1\\}。

\* ：匹配其前面出现的内容任意次，等价于\\{0,\\}，所以 ".*" 表述任意字符任意次，即无论什么内容全部匹配。

#### 3. 位置锚定

^ ：锚定行首

$ ：锚定行尾。技巧："^$"用于匹配空白行。

\b或\<：锚定单词的词首。如"\blike"不会匹配alike，但是会匹配liker

\b或\>：锚定单词的词尾。如"\blike\b"不会匹配alike和liker，只会匹配like

\B ：与\b作用相反。

#### 4. 分组及引用

\\(string\\) ：将string作为一个整体方便后面引用

\\1 ：引用第1个左括号及其对应的右括号所匹配的内容。

\\2 ：引用第2个左括号及其对应的右括号所匹配的内容。

\\n ：引用第n个左括号及其对应的右括号所匹配的内容。

### 三、扩展的（Extend）正则表达式
要使用扩展的正则表达式要加-E选项，或者直接使用egrep

#### 1. 匹配字符
这部分和基本正则表达式一样
 
#### 2. 匹配次数
\* ：和基本正则表达式一样

? ：基本正则表达式是\?，二这里没有\

{m,n} ：相比基本正则表达式也是没有了\

\+ ：匹配其前面的字符至少一次，相当于{1,}
 
#### 3. 位置锚定
和基本正则表达式一样
 
#### 4. 分组及引用
(string) ：相比基本正则表达式也是没有了\

\\1 ：引用部分和基本正则表达式一样

\\n ：引用部分和基本正则表达式一样
 
**注意**
1. 贪婪匹配
默认情况下，正则表达式的匹配工作在贪婪模式下，也就是说它会尽可能长地去匹配，比如某一行有字符串 abacb，如果搜索内容为 "a.*b" 那么会直接匹配 abacb这个串，而不会只匹配ab或acb。

2. 转义字符的使用
所有的正则字符，如 [ 、* 、( 等，若要搜索 * ，而不是想把 * 解释为重复先前字符任意次，可以使用 \\* 来转义。
